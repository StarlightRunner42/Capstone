<!DOCTYPE html>
<html lang="en">
<head>
    <title>Senior Citizens</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- Favicon -->
    <link rel="icon" href="/assets/images/silay.png" type="image/x-icon">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,600,800" rel="stylesheet">
    <!-- CSS Frameworks -->
    <link rel="stylesheet" href="/bower_components/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="/assets/icon/feather/css/feather.css">
    <link rel="stylesheet" href="/assets/css/style.css">
    <link rel="stylesheet" href="/assets/css/pwd.css">
    <link rel="stylesheet" href="/assets/css/jquery.mCustomScrollbar.css">
    <!-- DataTables CSS -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">
</head>
<body>
    <!-- Pre-loader start -->
    <div class="theme-loader">
        <div class="ball-scale">
            <div class='contain'>
                <div class="ring">
                    <div class="frame"></div>
                </div>
                <div class="ring">
                    <div class="frame"></div>
                </div>
                <div class="ring">
                    <div class="frame"></div>
                </div>
                <div class="ring">
                    <div class="frame"></div>
                </div>
                <div class="ring">
                    <div class="frame"></div>
                </div>
                <div class="ring">
                    <div class="frame"></div>
                </div>
                <div class="ring">
                    <div class="frame"></div>
                </div>
                <div class="ring">
                    <div class="frame"></div>
                </div>
                <div class="ring">
                    <div class="frame"></div>
                </div>
                <div class="ring">
                    <div class="frame"></div>
                </div>
            </div>
        </div>
    </div>
    <!-- Pre-loader end -->
    <div id="pcoded" class="pcoded">
        <div class="pcoded-overlay-box"></div>
        <div class="pcoded-container navbar-wrapper">
            <nav class="navbar header-navbar pcoded-header">
                <div class="navbar-wrapper">
                    <div class="navbar-logo">
                        <a class="mobile-menu" id="mobile-collapse" href="#!">
                            <i class="feather icon-menu"></i>
                        </a>
                        <a href="index-1.htm">
                            <img class="img-fluid" src="\assets\images\logo.png" alt="Theme-Logo">
                        </a>
                        <a class="mobile-options">
                            <i class="feather icon-more-horizontal"></i>
                        </a>
                    </div>
                    <div class="navbar-container container-fluid">
                        <ul class="nav-left">
                            <li class="header-search">
                                <div class="main-search morphsearch-search">
                                    <div class="input-group">
                                        <span class="input-group-addon search-close">
                                            <i class="feather icon-x"></i>
                                        </span>
                                        <input type="text" class="form-control" placeholder="Search...">
                                        <span class="input-group-addon search-btn">
                                            <i class="feather icon-search"></i>
                                        </span>
                                    </div>
                                </div>
                            </li>
                            <li>
                                <a href="#!" onclick="javascript:toggleFullScreen()">
                                    <i class="feather icon-maximize full-screen"></i>
                                </a>
                            </li>
                            <li>
                                <a href="/add_senior" class="btn btn-primary rounded" id="addSeniorBtn" target="_blank">
                                    <i class="feather icon-user-plus"></i>ADD SENIOR </a>
                            </li>
                        </ul>
                        <ul class="nav-right"></ul>
                        <ul class="nav-right">
                            <li class="user-profile header-notification">
                                <div class="dropdown-primary dropdown">
                                    <div class="dropdown-toggle" data-toggle="dropdown">
                                        <img src="\assets\images\avatar-4.jpg" class="img-radius" alt="User-Profile-Image">
                                        <span>John Doe</span>
                                        <i class="feather icon-chevron-down"></i>
                                    </div>
                                    <ul class="show-notification profile-notification dropdown-menu" data-dropdown-in="fadeIn" data-dropdown-out="fadeOut">
                                        <li>
                                            <a href="#!">
                                                <i class="feather icon-settings"></i> Settings </a>
                                        </li>
                                        <li>
                                            <a href="/logout">
                                                <i class="feather icon-log-out"></i> Logout </a>
                                        </li>
                                    </ul>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>
            <div class="pcoded-main-container">
                <div class="pcoded-wrapper">
                    <nav class="pcoded-navbar">
                        <div class="pcoded-inner-navbar main-menu">
                            <div class="pcoded-navigatio-lavel">Navigation</div>
                            <ul class="pcoded-item pcoded-left-item">
                                <li class="pcoded-hasmenu active pcoded-trigger">
                                    <a href="javascript:void(0)">
                                        <span class="pcoded-micon">
                                            <i class="feather icon-home"></i>
                                        </span>
                                        <span class="pcoded-mtext">Dashboard</span>
                                    </a>
                                    <ul class="pcoded-submenu">
                                        <li class="">
                                            <a href="/Pwd-form">
                                                <span class="">PDAO</span>
                                            </a>
                                        </li>
                                        <li class="active">
                                            <a href="/Senior-form">
                                                <span class="">OSCA</span>
                                            </a>
                                        </li>
                                    </ul>
                                </li>
                            </ul>
                        </div>
                    </nav>
                    <div class="pcoded-content">
                        <div class="pcoded-inner-content">
                            <div class="main-body">
                                <div class="page-wrapper">

                                    <div class="container">
                                        <h1>SENIOR CITIZENS</h1>
                                        <div class="filter-container">
                                            <div class="filter-group">
                                                <label for="barangay-filter">Barangay:</label>
                                                <select id="barangay-filter" class="form-control">
                                                    <option value="">All Barangays</option>
                                                    <% Object.keys(barangays).forEach(barangay => { %>
                                                        <option value="<%= barangay %>"><%= barangay %></option>
                                                    <% }) %>
                                                </select>
                                            </div>
                                            <div class="filter-group">
                                                <label for="purok-filter">Purok:</label>
                                                <select id="purok-filter" class="form-control" disabled>
                                                    <option value="">First select a Barangay</option>
                                                </select>
                                            </div>
                                        </div>
                                        
                            
                                        
                                        <% if (seniorCitizens && seniorCitizens.length > 0) { %>
                                            <table id="example" class="display" style="width:100%">
                                                <thead>
                                                    <tr>
                                                        <th>Full Name</th>
                                                        <th>Age</th>
                                                        <th>Barangay</th>
                                                        <th>Purok</th>
                                                        <th>Civil Status</th>
                                                        <th>Actions</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <% seniorCitizens.forEach(senior => { %>
                                                        <tr>
                                                            <td>
                                                                <%= senior.identifying_information.name.last_name %>
                                                                <%= senior.identifying_information.name.first_name %> 
                                                                <%= senior.identifying_information.name.middle_name || '' %>
                                                            </td>
                                                            <td><%= senior.identifying_information.age %></td>
                                                            <td><%= senior.identifying_information.address.barangay %></td>
                                                            <td><%= senior.identifying_information.address.purok %></td>
                                                            <td><%= senior.identifying_information.marital_status %></td>
                                                            <td>
                                                                <div class="action-container">
                                                                    <button class="action action-primary view-btn" 
                                                                            aria-label="View" 
                                                                            data-toggle="modal" 
                                                                            data-target="#viewModal"
                                                                            data-senior='<%= JSON.stringify(senior).replace(/'/g, "&apos;") %>'>
                                                                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                                                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                                                                        </svg>
                                                                    </button>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    <% }); %>
                                                </tbody>
                                            </table>
                                        <% } else { %>
                                            <div class="alert alert-info text-center">No senior citizens found.</div>
                                        <% } %>
                                    </div>
                                    
                                   <!-- View Modal -->
<div class="modal fade" id="viewModal" tabindex="-1" role="dialog" aria-labelledby="viewModalTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="viewModalTitle">
                    <span id="displayLastName"></span>, 
                    <span id="displayFirstName"></span> 
                    <span id="displayMiddleName"></span>
                </h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            
            <div class="modal-body">
                <!-- Top Row: Personal Information + Contact Information -->
                <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                    <!-- Left - Personal Information -->
                    <fieldset class="compact-spacing">
                        <legend>PERSONAL INFORMATION</legend>
                        <p class="compact-spacing">
                            <strong>Address:</strong> 
                            <span id="displayBarangay"></span>, 
                            <span id="displayPurok"></span>
                        </p>
                        <p class="compact-spacing">
                            <strong>Birthday:</strong> 
                            <span id="displayBirthday"></span> 
                            (<span id="displayAge"></span> years old)
                        </p>
                        <p class="compact-spacing">
                            <strong>Gender:</strong> 
                            <span id="displayGender"></span>
                        </p>
                        <p class="compact-spacing">
                            <strong>Marital Status:</strong> 
                            <span id="displayCivilStatus"></span>
                        </p>
                        <p class="compact-spacing">
                            <strong>Place of Birth:</strong> 
                            <span id="displayPlaceOfBirth"></span>
                        </p>
                        <p id="displaySpouse" class="compact-spacing" style="display:none;">
                            <strong>Spouse:</strong> 
                            <span id="displaySpouseName"></span>
                        </p>
                        <p class="compact-spacing">
                            <strong>Father:</strong> 
                            <span id="displayFatherName"></span>
                        </p>
                        <p class="no-bottom-margin">
                            <strong>Mother:</strong> 
                            <span id="displayMotherName"></span>
                        </p>
                    </fieldset>
                    
                    <!-- Right - Contact Information -->
                    <fieldset class="compact-spacing">
                        <legend>CONTACT INFORMATION</legend>
                        <div id="displayContacts">
                            <!-- Contact information will be dynamically inserted here -->
                        </div>
                    </fieldset>
                </div>

                <!-- Middle Row: ID Information + Education & Skills -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                    <!-- Left - ID Information -->
                    <fieldset class="compact-spacing">
                        <legend>ID INFORMATION</legend>
                        <p class="compact-spacing">
                            <strong>OSCA ID:</strong> 
                            <span id="displayOscaId"></span>
                        </p>
                        <p class="compact-spacing">
                            <strong>GSIS/SSS:</strong> 
                            <span id="displayGsisSss"></span>
                        </p>
                        <p class="compact-spacing">
                            <strong>Philhealth:</strong> 
                            <span id="displayPhilhealth"></span>
                        </p>
                        <p class="compact-spacing">
                            <strong>TIN:</strong> 
                            <span id="displayTin"></span>
                        </p>
                        <p class="no-bottom-margin">
                            <strong>Other Govt ID:</strong> 
                            <span id="displayOtherGovtId"></span>
                        </p>
                    </fieldset>
                    
                    <!-- Right - Education & Skills -->
                    <fieldset class="compact-spacing">
                        <legend>EDUCATION & SKILLS</legend>
                        <p class="compact-spacing">
                            <strong>Education:</strong> 
                            <span id="displayEducation"></span>
                        </p>
                        <p class="no-bottom-margin">
                            <strong>Skills:</strong> 
                            <span id="displaySkills"></span>
                        </p>
                    </fieldset>
                </div>

                <!-- Bottom Row: Family Composition + Community Service -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                    <!-- Left - Family Composition -->
                    <fieldset class="compact-spacing">
                        <legend>FAMILY COMPOSITION</legend>
                        <div id="displayChildren">
                            <!-- Family composition will be dynamically inserted here -->
                        </div>
                    </fieldset>

                    <!-- Right - Community Service -->
                    <fieldset class="compact-spacing">
                        <legend>COMMUNITY SERVICE</legend>
                        <div id="displayCommunityService">
                            <!-- Community service will be dynamically inserted here -->
                        </div>
                    </fieldset>
                </div>
            </div>
            
            <div class="modal-footer flex-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary">Add ASS</button>
               <button class="action action-success" aria-label="Edit" data-toggle="modal" data-target="#editModal">
                                                                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                                                                        </svg>
                                                                    </button>
        </div>
    </div>
</div>


<!-- Edit Modal -->
<div class="modal fade" id="editModal" tabindex="-1" role="dialog" aria-labelledby="editModalTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editModalTitle">Edit Resident Information</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>

            <div class="modal-body">
                <form id="editResidentForm">
                    <!-- Top Row: Personal Info + Contact Info -->
                    <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                        
                        <!-- Left - Personal Information -->
                        <fieldset>
                            <legend>PERSONAL INFORMATION</legend>
                            
                            <div class="form-row">
                                <div class="form-group col-md-4">
                                    <label for="editLastName">Last Name:</label>
                                    <input type="text" class="form-control" id="editLastName">
                                </div>
                                <div class="form-group col-md-4">
                                    <label for="editFirstName">First Name:</label>
                                    <input type="text" class="form-control" id="editFirstName">
                                </div>
                                <div class="form-group col-md-4">
                                    <label for="editMiddleName">Middle Name:</label>
                                    <input type="text" class="form-control" id="editMiddleName">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="editBarangay">Barangay:</label>
                                <input type="text" class="form-control" id="editBarangay">
                            </div>

                            <div class="form-group">
                                <label for="editPurok">Purok:</label>
                                <input type="text" class="form-control" id="editPurok">
                            </div>

                            <div class="form-row">
                                <div class="form-group col-md-6">
                                    <label for="editBirthday">Birthday:</label>
                                    <input type="date" class="form-control" id="editBirthday">
                                </div>
                                <div class="form-group col-md-6">
                                    <label for="editAge">Age:</label>
                                    <input type="number" class="form-control" id="editAge" readonly>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="editGender">Gender:</label>
                                <select class="form-control" id="editGender">
                                    <option value="">Select Gender</option>
                                    <option value="Male">Male</option>
                                    <option value="Female">Female</option>
                                    <option value="Other">Other</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="editCivilStatus">Civil Status:</label>
                                <select class="form-control" id="editCivilStatus">
                                    <option value="">Select Civil Status</option>
                                    <option value="Single">Single</option>
                                    <option value="Married">Married</option>
                                    <option value="Widowed">Widowed</option>
                                    <option value="Separated">Separated</option>
                                </select>
                            </div>

                            <div class="form-group" id="editSpouseGroup" style="display:none;">
                                <label for="editSpouseName">Spouse Name:</label>
                                <input type="text" class="form-control" id="editSpouseName">
                            </div>

                            <div class="form-group">
                                <label for="editPlaceOfBirth">Place of Birth:</label>
                                <input type="text" class="form-control" id="editPlaceOfBirth">
                            </div>

                            <div class="form-group">
                                <label for="editFatherName">Father's Name:</label>
                                <input type="text" class="form-control" id="editFatherName">
                            </div>

                            <div class="form-group">
                                <label for="editMotherName">Mother's Name:</label>
                                <input type="text" class="form-control" id="editMotherName">
                            </div>
                        </fieldset>

                        <!-- Right - Contact Information -->
                        <fieldset>
                            <legend>CONTACT INFORMATION</legend>
                            <div id="editContactsContainer">
                                <!-- Existing contact fields will be dynamically inserted here -->
                            </div>
                        </fieldset>
                    </div>

                    <!-- Middle Row: ID Information + Education & Skills -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                        
                        <!-- Left - ID Information -->
                        <fieldset>
                            <legend>ID INFORMATION</legend>
                            <div class="form-group">
                                <label for="editOscaId">OSCA ID:</label>
                                <input type="text" class="form-control" id="editOscaId">
                            </div>
                            <div class="form-group">
                                <label for="editGsisSss">GSIS / SSS:</label>
                                <input type="text" class="form-control" id="editGsisSss">
                            </div>
                            <div class="form-group">
                                <label for="editPhilhealth">Philhealth:</label>
                                <input type="text" class="form-control" id="editPhilhealth">
                            </div>
                            <div class="form-group">
                                <label for="editTin">TIN:</label>
                                <input type="text" class="form-control" id="editTin">
                            </div>
                            <div class="form-group">
                                <label for="editOtherGovtId">Other Gov't ID:</label>
                                <input type="text" class="form-control" id="editOtherGovtId">
                            </div>
                        </fieldset>

                        <!-- Right - Education & Skills -->
                        <fieldset>
                            <legend>EDUCATION & SKILLS</legend>
                            <div class="form-group">
                                <label for="editEducation">Education:</label>
                                <select class="form-control" id="editEducation">
                                    <option value="">Select Education Level</option>
                                    <option value="Elementary">Elementary</option>
                                    <option value="High School">High School</option>
                                    <option value="College Undergraduate">College Undergraduate</option>
                                    <option value="College Graduate">College Graduate</option>
                                    <option value="Vocational">Vocational</option>
                                    <option value="Post Graduate">Post Graduate</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="editSkills">Skills:</label>
                                <textarea class="form-control" id="editSkills" rows="3"></textarea>
                            </div>
                        </fieldset>
                    </div>

                    <!-- Bottom Row: Family Composition + Community Service -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                        
                        <!-- Left - Family Composition -->
                        <fieldset>
                            <legend>FAMILY COMPOSITION</legend>
                            <div id="editChildrenContainer">
                                <!-- Existing family member fields will be dynamically inserted here -->
                            </div>
                        </fieldset>

                        <!-- Right - Community Service -->
                        <fieldset>
                            <legend>COMMUNITY SERVICE</legend>
                            <div id="editCommunityServiceContainer">
                                <!-- Existing community service fields will be dynamically inserted here -->
                            </div>
                        </fieldset>
                    </div>
                </form>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" id="saveChangesBtn">Save Changes</button>
            </div>
        </div>
    </div>
</div>


                                   
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Convert EJS data to JavaScript object
        const barangaysData = <%- JSON.stringify(barangays) %>;
        const seniorCitizensData = <%- JSON.stringify(seniorCitizens) %>;
        
        // Wait for DOM to be fully loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Get select elements
            const barangaySelect = document.getElementById('barangay-filter');
            const purokSelect = document.getElementById('purok-filter');
            
            // Initialize purok dropdown as disabled
            purokSelect.disabled = true;

            // Barangay change event handler
            barangaySelect.addEventListener('change', function() {
                const selectedBarangay = this.value;
                purokSelect.innerHTML = '';
                
                const defaultOption = document.createElement('option');
                defaultOption.value = '';
                defaultOption.textContent = 'Select Purok';
                purokSelect.appendChild(defaultOption);
                
                purokSelect.disabled = !selectedBarangay;
                
                if (selectedBarangay && barangaysData[selectedBarangay]) {
                    const allOption = document.createElement('option');
                    allOption.value = 'all';
                    allOption.textContent = 'All Puroks';
                    purokSelect.appendChild(allOption);
                    
                    barangaysData[selectedBarangay].forEach(purok => {
                        const option = document.createElement('option');
                        option.value = purok;
                        option.textContent = purok;
                        purokSelect.appendChild(option);
                    });
                }
            });

            // Senior Citizen View Modal Handler
            const viewButtons = document.querySelectorAll('.view-btn');
            
            viewButtons.forEach(button => {
                button.addEventListener('click', function() {
                    try {
                        const seniorData = JSON.parse(this.getAttribute('data-senior'));
                        console.log('Senior Data:', seniorData);
                        
                        // Name Information
                        const name = seniorData.identifying_information?.name || {};
                        document.getElementById('displayFirstName').textContent = name.first_name || 'N/A';
                        document.getElementById('displayMiddleName').textContent = name.middle_name || '';
                        document.getElementById('displayLastName').textContent = name.last_name || 'N/A';
                        if (name.extension) {
                            document.getElementById('displayLastName').textContent += ` ${name.extension}`;
                        }
                        
                        // Address Information
                        const address = seniorData.identifying_information?.address || {};
                        document.getElementById('displayBarangay').textContent = address.barangay || 'N/A';
                        document.getElementById('displayPurok').textContent = address.purok || 'N/A';
                        
                        // Personal Information
                        const dob = seniorData.identifying_information?.date_of_birth;
                        document.getElementById('displayBirthday').textContent = dob ? new Date(dob).toLocaleDateString() : 'N/A';
                        document.getElementById('displayAge').textContent = seniorData.identifying_information?.age || 'N/A';
                        document.getElementById('displayGender').textContent = seniorData.identifying_information?.gender || 'N/A';
                        document.getElementById('displayCivilStatus').textContent = seniorData.identifying_information?.marital_status || 'N/A';
                        document.getElementById('displayPlaceOfBirth').textContent = 
                            Array.isArray(seniorData.identifying_information?.place_of_birth) ? 
                            seniorData.identifying_information.place_of_birth.join(', ') : 
                            'N/A';
                        
                        // Spouse Information
                        if (seniorData.family_composition?.spouse?.name) {
                            document.getElementById('displaySpouse').style.display = 'block';
                            document.getElementById('displaySpouseName').textContent = seniorData.family_composition.spouse.name;
                        } else {
                            document.getElementById('displaySpouse').style.display = 'none';
                        }
                        
                        // Parent Information
                        const father = seniorData.family_composition?.father || {};
                        const mother = seniorData.family_composition?.mother || {};
                        const fatherName = `${father.first_name || ''} ${father.middle_name || ''} ${father.last_name || ''} ${father.extension || ''}`.trim();
                        const motherName = `${mother.first_name || ''} ${mother.middle_name || ''} ${mother.last_name || ''}`.trim();
                        
                        document.getElementById('displayFatherName').textContent = fatherName || 'N/A';
                        document.getElementById('displayMotherName').textContent = motherName || 'N/A';
                        
                        // Contact Information
                        const contactsContainer = document.getElementById('displayContacts');
                        contactsContainer.innerHTML = '';
                        
                        if (seniorData.identifying_information?.contacts?.length > 0) {
                            seniorData.identifying_information.contacts.forEach(contact => {
                                const contactElement = document.createElement('div');
                                contactElement.className = 'contact-item';
                                contactElement.innerHTML = `
                                    <p><strong>${contact.type ? contact.type.toUpperCase() : 'CONTACT'}:</strong></p>
                                    <p>Name: ${contact.name || 'N/A'}</p>
                                    <p>Relationship: ${contact.relationship || 'N/A'}</p>
                                    <p>Phone: ${contact.phone || 'N/A'}</p>
                                    ${contact.email ? `<p>Email: ${contact.email}</p>` : ''}
                                    <hr>
                                `;
                                contactsContainer.appendChild(contactElement);
                            });
                        } else {
                            contactsContainer.innerHTML = '<p>No contact information available</p>';
                        }
                        
                        // ID Information
                        const ids = seniorData.identifying_information || {};
                        document.getElementById('displayOscaId').textContent = ids.osca_id_number || 'N/A';
                        document.getElementById('displayGsisSss').textContent = ids.gsis_sss || 'N/A';
                        document.getElementById('displayPhilhealth').textContent = ids.philhealth || 'N/A';
                        document.getElementById('displayTin').textContent = ids.tin || 'N/A';
                        document.getElementById('displayOtherGovtId').textContent = ids.other_govt_id || 'N/A';
                        
                        // Family Composition - Children
                        const childrenContainer = document.getElementById('displayChildren');
                        childrenContainer.innerHTML = '';
                        
                        if (seniorData.family_composition?.children?.length > 0) {
                            seniorData.family_composition.children.forEach(child => {
                                const childElement = document.createElement('div');
                                childElement.className = 'child-item';
                                childElement.innerHTML = `
                                    <p><strong>${child.full_name || 'Unnamed Child'}</strong></p>
                                    <p>Age: ${child.age || 'N/A'}</p>
                                    <p>Occupation: ${child.occupation || 'N/A'}</p>
                                    <p>Income: ${child.income || 'N/A'}</p>
                                    <p>Working Status: ${child.working_status || 'N/A'}</p>
                                    <hr>
                                `;
                                childrenContainer.appendChild(childElement);
                            });
                        } else {
                            childrenContainer.innerHTML = '<p>No children information available</p>';
                        }
                        
                        // Education and Skills
                        const education = seniorData.education_hr_profile || {};
                        document.getElementById('displayEducation').textContent = 
                            Array.isArray(education.educational_attainment) ? 
                            education.educational_attainment.join(', ') : 'N/A';
                        document.getElementById('displaySkills').textContent = 
                            Array.isArray(education.skills) ? 
                            education.skills.join(', ') : 'N/A';
                            
                        // Community Service
                        const serviceContainer = document.getElementById('displayCommunityService');
                        serviceContainer.innerHTML = '';
                        
                        if (seniorData.community_service?.length > 0) {
                            seniorData.community_service.forEach(service => {
                                const serviceElement = document.createElement('p');
                                serviceElement.textContent = service;
                                if (service === 'Other' && seniorData.community_service_other_text) {
                                    serviceElement.textContent += ` (${seniorData.community_service_other_text})`;
                                }
                                serviceContainer.appendChild(serviceElement);
                            });
                        } else {
                            serviceContainer.innerHTML = '<p>No community service recorded</p>';
                        }
                        
                    } catch (e) {
                        console.error('Error parsing senior data:', e);
                    }
                });
            });

            // Initialize DataTable
            var table = $('#example').DataTable({
                paging: true,
                pageLength: 10,
                lengthMenu: [5, 10, 25, 50, 100],
                responsive: true,
                rowCallback: function(row) {
                    if ($(row).hasClass('dt-empty')) {
                        $(row).hide();
                    }
                }
            });

            // Search input functionality
            $('#seniorSearchInput').on('keyup', function() {
                table.search(this.value).draw();
            });

            // Clear search button
            $('#clearSearchBtn').on('click', function() {
                $('#seniorSearchInput').val('');
                table.search('').draw();
            });

            // Combine with existing filters
            $('#barangay-filter, #purok-filter').on('change', function() {
                table.draw();
            });

            // Custom filtering function
            $.fn.dataTable.ext.search.push(
                function(settings, data, dataIndex) {
                    var barangay = $('#barangay-filter').val();
                    var purok = $('#purok-filter').val();
                    
                    // If no barangay is selected, show all
                    if (!barangay) return true;
                    
                    var rowBarangay = data[2]; // Barangay is in the 3rd column (index 2)
                    var rowPurok = data[3]; // Purok is in the 4th column (index 3)
                    
                    // Filter by barangay
                    if (barangay && rowBarangay !== barangay) return false;
                    
                    // Filter by purok if selected and not "all"
                    if (purok && purok !== 'all' && rowPurok !== purok) return false;
                    
                    return true;
                }
            );
        });
    </script>

    <!-- Required Jquery -->
    <script type="text/javascript" src="\bower_components\jquery\js\jquery.min.js"></script>
    <script type="text/javascript" src="\bower_components\jquery-ui\js\jquery-ui.min.js"></script>
    <script type="text/javascript" src="\bower_components\popper.js\js\popper.min.js"></script>
    <script type="text/javascript" src="\bower_components\bootstrap\js\bootstrap.min.js"></script>
    <!-- DataTables JS -->
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <!-- Other scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.1/chart.min.js"></script>
    <script type="text/javascript" src="\bower_components\jquery-slimscroll\js\jquery.slimscroll.js"></script>
    <script type="text/javascript" src="\bower_components\modernizr\js\modernizr.js"></script>
    <script type="text/javascript" src="\bower_components\modernizr\js\css-scrollbars.js"></script>
    <script type="text/javascript" src="\bower_components\chart.js\js\Chart.js"></script>
    <script src="\assets\pages\widget\amchart\amcharts.js"></script>
    <script src="\assets\pages\widget\amchart\serial.js"></script>
    <script src="\assets\pages\widget\amchart\light.js"></script>
    <script type="text/javascript" src="\assets\js\SmoothScroll.js"></script>
    <script src="\assets\js\pcoded.min.js"></script>
    <script src="\assets\js\jquery.mCustomScrollbar.concat.min.js"></script>
    <script src="\assets\js\vartical-layout.min.js"></script>
    <script type="text/javascript" src="\assets\pages\dashboard\analytic-dashboard.min.js"></script>
    <script type="text/javascript" src="\assets\js\script.js"></script>
    <script type="text/javascript" src="\assets\js\senior.js"></script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-23581568-13"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() {
            dataLayer.push(arguments);
        }
        gtag('js', new Date());
        gtag('config', 'UA-23581568-13');
    </script>
</body>
</html>