<!DOCTYPE html>
<html lang="en">
	<head>
		<title>LYDO OFFICE</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<!-- Favicon -->
		<link rel="icon" href="/assets/images/silay.png" type="image/x-icon">
		<!-- Google Fonts -->
		<link href="https://fonts.googleapis.com/css?family=Open+Sans:400,600,800" rel="stylesheet">
		<!-- CSS Frameworks -->
		<link rel="stylesheet" href="/bower_components/bootstrap/css/bootstrap.min.css">
		<link rel="stylesheet" href="/assets/icon/feather/css/feather.css">
		<link rel="stylesheet" href="/assets/css/style.css">
		<link rel="stylesheet" href="/assets/css/pwd.css">
		<link rel="stylesheet" href="/assets/css/jquery.mCustomScrollbar.css">
		<!-- DataTables CSS -->
		<link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">
	</head>
	<body> 
		<!-- Pre-loader start -->
		<div class="theme-loader">
			<div class="ball-scale">
				<div class='contain'>
					<div class="ring">
						<div class="frame"></div>
					</div>
					<div class="ring">
						<div class="frame"></div>
					</div>
					<div class="ring">
						<div class="frame"></div>
					</div>
					<div class="ring">
						<div class="frame"></div>
					</div>
					<div class="ring">
						<div class="frame"></div>
					</div>
					<div class="ring">
						<div class="frame"></div>
					</div>
					<div class="ring">
						<div class="frame"></div>
					</div>
					<div class="ring">
						<div class="frame"></div>
					</div>
					<div class="ring">
						<div class="frame"></div>
					</div>
					<div class="ring">
						<div class="frame"></div>
					</div>
				</div>
			</div>
		</div>
		<!-- Pre-loader end -->
		<div id="pcoded" class="pcoded">
			<div class="pcoded-overlay-box"></div>
			<div class="pcoded-container navbar-wrapper">
				<nav class="navbar header-navbar pcoded-header">
					<div class="navbar-wrapper">
						<div class="navbar-logo">
							<a class="mobile-menu" id="mobile-collapse" href="#!">
								<i class="feather icon-menu"></i>
							</a>
							<a href="">
								<a href="#" class="img-fluid">YOUTH</a>
							</a>
							<a class="mobile-options">
								<i class="feather icon-more-horizontal"></i>
							</a>
						</div>
						<div class="navbar-container container-fluid">
							<ul class="nav-left">
								<li class="header-search">
									<div class="main-search morphsearch-search">
										<div class="input-group">
											<span class="input-group-addon search-close">
												<i class="feather icon-x"></i>
											</span>
											<input type="text" class="form-control" placeholder="Search...">
											<span class="input-group-addon search-btn">
												<i class="feather icon-search"></i>
											</span>
										</div>
									</div>
								</li>
								<li>
									<a href="#!" onclick="javascript:toggleFullScreen()">
										<i class="feather icon-maximize full-screen"></i>
									</a>
								</li>
								<li>
									<a href="/youth-form" class="btn btn-primary rounded" id="addSeniorBtn" target="_blank">
										<i class="feather icon-user-plus"></i>ADD LYDO </a>
								</li>
							</ul>
							<ul class="nav-right"></ul>
							<ul class="nav-right">
								<li class="user-profile header-notification">
									<div class="dropdown-primary dropdown">
										<div class="dropdown-toggle" data-toggle="dropdown">
											<img src="\assets\images\avatar-4.jpg" class="img-radius" alt="User-Profile-Image">
											<span>John Doe</span>
											<i class="feather icon-chevron-down"></i>
										</div>
										<ul class="show-notification profile-notification dropdown-menu" data-dropdown-in="fadeIn" data-dropdown-out="fadeOut">
											<li>
												<a href="#!">
													<i class="feather icon-settings"></i> Settings </a>
											</li>
											<li>
												<a href="/logout">
													<i class="feather icon-log-out"></i> Logout </a>
											</li>
										</ul>
									</div>
								</li>
							</ul>
						</div>
					</div>
				</nav>
				<div class="pcoded-main-container">
					<div class="pcoded-wrapper">
						<nav class="pcoded-navbar">
							<div class="pcoded-inner-navbar main-menu">
								<div class="pcoded-navigatio-lavel">Navigation</div>
								<ul class="pcoded-item pcoded-left-item">
									<li class="pcoded-hasmenu active pcoded-trigger">
										<a href="javascript:void(0)">
											<span class="pcoded-micon">
												<i class="feather icon-home"></i>
											</span>
											<span class="pcoded-mtext">Dashboard</span>
										</a>
										<ul class="pcoded-submenu">
											<li class="active">
												<a href="/youth">
													<span class="">LYDO</span>
												</a>
											</li>
										</ul>
									</li>
								</ul>
							</div>
						</nav>
						<div class="pcoded-content">
							<div class="pcoded-inner-content">
								<div class="main-body">
									<div class="page-wrapper">

										<div class="container">
											<h1>LYDO TABLE</h1>
											<div class="filter-container">
												<div class="filter-group">
													<label for="barangay-filter">Barangay:</label>
													<select id="barangay-filter" class="form-control">
														<option value="">Select Barangay</option>
														<!-- Populate options with JavaScript -->
													</select>
												</div>
												<div class="filter-group">
													<label for="purok-filter">Purok:</label>
													<select id="purok-filter" class="form-control" disabled>
														<option value="">First select a Barangay</option>
													</select>
												</div>
											</div>
											<div id="data-table-container">
												<table id="example" class="display" style="width:100%;">
													<thead>
														<tr>
															<th>Name</th>
															<th>Age</th>
															<th>Barangay</th>
															<th>Purok</th>
															<th>Actions</th>
														</tr>
													</thead>
													<tbody id="pwd-table-body"><% if (youths && youths.length > 0) { %><% youths.forEach((youth, index) => { %> <tr>
															<td><%= youth.first_name %><%= youth.middle_name %><%= youth.last_name %> </td>
															<td><%= youth.age %> </td>
															<td><%= youth.barangay %> </td>
															<td><%= youth.purok %> </td>
															<td>
																<div class="action-container">
																	<button class="action action-primary" aria-label="View" data-toggle="modal" data-target="#viewModal">
																		<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
																			<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
																			<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
																		</svg>
																	</button>
																</div>
																
																<!-- View Modal -->
<div class="modal fade" id="viewModal" tabindex="-1" role="dialog" aria-labelledby="viewModalTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="viewModalTitle">
                    <span id="displayFirstName"></span> 
                    <span id="displayMiddleName"></span> 
                    <span id="displayLastName"></span>
                </h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <!-- Top Row: Personal Info + Contact Info -->
                <div style="display: flex; justify-content: space-between; margin-bottom: 20px;">
                    <!-- Left - Personal Information -->
                    <fieldset style="flex: 1; margin-right: 10px;">
                        <legend>PERSONAL INFORMATION</legend>
                        <p>
                            <strong>Contact:</strong>
                            <span id="displayContact"></span>
                        </p>
                        <p>
                            <strong>Birthday:</strong>
                            <span id="displayBirthday"></span> ( <span id="displayAge"></span> years old)
                        </p>
                        <p>
                            <strong>Gender:</strong>
                            <span id="displayGender"></span>
                        </p>
                        <p>
                            <strong>Place of Birth:</strong>
                            <span id="displayPlaceOfBirth"></span>
                        </p>
                    </fieldset>
                    <!-- Right - Education Information -->
                    <fieldset style="flex: 1; margin-left: 10px;">
                        <legend>EDUCATIONAL INFORMATION</legend>
                        <p>
                            <strong>Education Level:</strong>
                            <span id="displayEducationLevel"></span>
                        </p>
                        <p>
                            <strong>SK Voter:</strong>
                            <span id="displaySkVoter"></span>
                        </p>
                        <p id="displaySkVoted" style="display: none;">
                            <strong>Voted Last SK:</strong>
                            <span id="displaySkVotedStatus"></span>
                        </p>
                        <p>
                            <strong>National Voter:</strong>
                            <span id="displayNationalVoter"></span>
                        </p>
                        <p>
                            <strong>Employment Status:</strong>
                            <span id="displayEmploymentStatus"></span>
                        </p>
                        <p id="displayEmploymentCategory" style="display: none;">
                            <strong>Employment Category:</strong>
                            <span id="displayEmploymentCategoryValue"></span>
                        </p>
                        <p id="displayEmploymentType" style="display: none;">
                            <strong>Employment Type:</strong>
                            <span id="displayEmploymentTypeValue"></span>
                        </p>
                    </fieldset>
                </div>
                <!-- Bottom Row: Youth Classification + Age Group -->
                <div style="display: flex; justify-content: space-between;">
                    <!-- Left - Youth Classification -->
                    <fieldset style="flex: 1; margin-right: 10px;">
                        <legend>YOUTH CLASSIFICATION</legend>
                        <div id="displayYouthClassification"></div>
                    </fieldset>
                    <!-- Right - Youth Age Group -->
                    <fieldset style="flex: 1; margin-left: 10px;">
                        <legend>YOUTH AGE GROUP</legend>
                        <div id="displayYouthAgeGroup"></div>
                    </fieldset>
                </div>
                <!-- KK Assembly Information -->
                <div style="margin-top: 20px;">
                    <fieldset>
                        <legend>KK ASSEMBLY INFORMATION</legend>
                        <p>
                            <strong>Attended KK Assembly:</strong>
                            <span id="displayAssemblyAttended"></span>
                        </p>
                        <div id="displayAssemblyTimes" style="display: none;">
                            <p>
                                <strong>Times Attended:</strong>
                                <span id="displayAssemblyTimesValue"></span>
                            </p>
                        </div>
                        <div id="displayAssemblyReason" style="display: none;">
                            <p>
                                <strong>Reason for Not Attending:</strong>
                                <span id="displayAssemblyReasonValue"></span>
                            </p>
                        </div>
                    </fieldset>
                </div>
            </div>
            <div class="modal-footer flex-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary">Add ASS</button>
				<button class="action action-success" aria-label="Edit" data-toggle="modal" data-target="#editModal">
																	<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
																		<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
																	</svg>
																</button>
															</div>

            </div>
        </div>
    </div>
</div>

<!-- Edit Modal -->
<div class="modal fade" id="editModal" tabindex="-1" role="dialog" aria-labelledby="editModalTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editModalTitle">Edit Resident Information</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>

            <div class="modal-body">
                <form id="editResidentForm">
                    <!-- Top Row: Personal Info + Contact Info -->
                <div style="display: flex; justify-content: space-between; margin-bottom: 20px;">
                    <!-- Left - Personal Information -->
                    <fieldset style="flex: 1; margin-right: 10px;">
                        <legend>PERSONAL INFORMATION</legend>
                        <p>
                            <strong>Contact:</strong>
                            <span id="displayContact"></span>
                        </p>
                        <p>
                            <strong>Birthday:</strong>
                            <span id="displayBirthday"></span> ( <span id="displayAge"></span> years old)
                        </p>
                        <p>
                            <strong>Gender:</strong>
                            <span id="displayGender"></span>
                        </p>
                        <p>
                            <strong>Place of Birth:</strong>
                            <span id="displayPlaceOfBirth"></span>
                        </p>
                    </fieldset>
                    <!-- Right - Education Information -->
                    <fieldset style="flex: 1; margin-left: 10px;">
                        <legend>EDUCATIONAL INFORMATION</legend>
                        <p>
                            <strong>Education Level:</strong>
                            <span id="displayEducationLevel"></span>
                        </p>
                        <p>
                            <strong>SK Voter:</strong>
                            <span id="displaySkVoter"></span>
                        </p>
                        <p id="displaySkVoted" style="display: none;">
                            <strong>Voted Last SK:</strong>
                            <span id="displaySkVotedStatus"></span>
                        </p>
                        <p>
                            <strong>National Voter:</strong>
                            <span id="displayNationalVoter"></span>
                        </p>
                        <p>
                            <strong>Employment Status:</strong>
                            <span id="displayEmploymentStatus"></span>
                        </p>
                        <p id="displayEmploymentCategory" style="display: none;">
                            <strong>Employment Category:</strong>
                            <span id="displayEmploymentCategoryValue"></span>
                        </p>
                        <p id="displayEmploymentType" style="display: none;">
                            <strong>Employment Type:</strong>
                            <span id="displayEmploymentTypeValue"></span>
                        </p>
                    </fieldset>
                </div>
                <!-- Bottom Row: Youth Classification + Age Group -->
                <div style="display: flex; justify-content: space-between;">
                    <!-- Left - Youth Classification -->
                    <fieldset style="flex: 1; margin-right: 10px;">
                        <legend>YOUTH CLASSIFICATION</legend>
                        <div id="displayYouthClassification"></div>
                    </fieldset>
                    <!-- Right - Youth Age Group -->
                    <fieldset style="flex: 1; margin-left: 10px;">
                        <legend>YOUTH AGE GROUP</legend>
                        <div id="displayYouthAgeGroup"></div>
                    </fieldset>
                </div>
                <!-- KK Assembly Information -->
                <div style="margin-top: 20px;">
                    <fieldset>
                        <legend>KK ASSEMBLY INFORMATION</legend>
                        <p>
                            <strong>Attended KK Assembly:</strong>
                            <span id="displayAssemblyAttended"></span>
                        </p>
                        <div id="displayAssemblyTimes" style="display: none;">
                            <p>
                                <strong>Times Attended:</strong>
                                <span id="displayAssemblyTimesValue"></span>
                            </p>
                        </div>
                        <div id="displayAssemblyReason" style="display: none;">
                            <p>
                                <strong>Reason for Not Attending:</strong>
                                <span id="displayAssemblyReasonValue"></span>
                            </p>
                        </div>
                    </fieldset>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" id="saveChangesBtn">Update</button>
            </div>
        </div>
    </div>
</div>
															</td>
														</tr><% }) %><% } else { %> <tr>
															<td colspan="5">No youth data found.</td>
														</tr><% } %> </tbody>
												</table>
												<div id="no-data-alert" class="alert alert-info text-center" style="display: none;"> No data found. </div>
											</div>
										</div>
										<!-- Container div -->
									</div>
								</div>
							</div>
						</div>
					</div>
					<div id="styleSelector"></div>
				</div>
			</div>
		</div>
		<!-- Required Jquery -->
		<script type="text/javascript" src="\bower_components\jquery\js\jquery.min.js"></script>
		<script type="text/javascript" src="\bower_components\jquery-ui\js\jquery-ui.min.js"></script>
		<script type="text/javascript" src="\bower_components\popper.js\js\popper.min.js"></script>
		<script type="text/javascript" src="\bower_components\bootstrap\js\bootstrap.min.js"></script>
		<!-- DataTables JS -->
		<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
		<!-- Other scripts -->
		<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.1/chart.min.js"></script>
		<script type="text/javascript" src="\bower_components\jquery-slimscroll\js\jquery.slimscroll.js"></script>
		<script type="text/javascript" src="\bower_components\modernizr\js\modernizr.js"></script>
		<script type="text/javascript" src="\bower_components\modernizr\js\css-scrollbars.js"></script>
		<script type="text/javascript" src="\bower_components\chart.js\js\Chart.js"></script>
		<script src="\assets\pages\widget\amchart\amcharts.js"></script>
		<script src="\assets\pages\widget\amchart\serial.js"></script>
		<script src="\assets\pages\widget\amchart\light.js"></script>
		<script type="text/javascript" src="\assets\js\SmoothScroll.js"></script>
		<script src="\assets\js\pcoded.min.js"></script>
		<script src="\assets\js\jquery.mCustomScrollbar.concat.min.js"></script>
		<script src="\assets\js\vartical-layout.min.js"></script>
		<script type="text/javascript" src="\assets\pages\dashboard\analytic-dashboard.min.js"></script>
		<script type="text/javascript" src="\assets\js\script.js"></script>
		<script type="text/javascript" src="\assets\js\senior.js"></script>
		<!-- Global site tag (gtag.js) - Google Analytics -->
		<script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-23581568-13"></script>
		<script>
			window.dataLayer = window.dataLayer || [];

			function gtag() {
				dataLayer.push(arguments);
			}
			gtag('js', new Date());
			gtag('config', 'UA-23581568-13');
			$(document).ready(function() {
				// Initialize DataTable only once
				if ($.fn.dataTable.isDataTable('#example')) {
					window.youthTable = $('#example').DataTable();
				} else {
					window.youthTable = $('#example').DataTable({
						paging: true,
						pageLength: 10,
						lengthMenu: [5, 10, 25, 50, 100],
						responsive: true,
						rowCallback: function(row) {
							if ($(row).hasClass('dt-empty')) {
								$(row).hide();
							}
						}
					});
				}

				// Barangay/Purok dynamic filters
				const barangaysData = <%- JSON.stringify(barangays) %>;
				const barangaySelect = document.getElementById('barangay-filter');
				const purokSelect = document.getElementById('purok-filter');
				const table = window.youthTable;

				// Populate Barangay options dynamically
				if (barangaysData && typeof barangaysData === 'object') {
					Object.keys(barangaysData).forEach(function(barangay) {
						const option = document.createElement('option');
						option.value = barangay;
						option.textContent = barangay;
						barangaySelect.appendChild(option);
					});
				}

				// Initialize purok dropdown as disabled
				purokSelect.disabled = true;

				// Barangay change: populate Purok and filter table
				barangaySelect.addEventListener('change', function() {
					const selectedBarangay = this.value;
					purokSelect.innerHTML = '';

					const defaultOption = document.createElement('option');
					defaultOption.value = '';
					defaultOption.textContent = selectedBarangay ? 'Select Purok' : 'First select a Barangay';
					purokSelect.appendChild(defaultOption);

					purokSelect.disabled = !selectedBarangay;

					if (selectedBarangay && barangaysData[selectedBarangay]) {
						const allOption = document.createElement('option');
						allOption.value = 'all';
						allOption.textContent = 'All Puroks';
						purokSelect.appendChild(allOption);

						barangaysData[selectedBarangay].forEach(function(purok) {
							const option = document.createElement('option');
							option.value = purok;
							option.textContent = purok;
							purokSelect.appendChild(option);
						});
					}

					// Filter the table based on selected barangay (column index 2)
					table.columns(2).search(selectedBarangay || '').draw();
					// Clear purok filter when barangay changes
					table.columns(3).search('').draw();
				});

				// Purok change: filter table
				purokSelect.addEventListener('change', function() {
					const selectedPurok = this.value;
					if (selectedPurok === 'all' || selectedPurok === '') {
						table.columns(3).search('').draw();
					} else {
						table.columns(3).search(selectedPurok).draw();
					}
				});
			});
		</script>
		<script>
			// Convert EJS data to JavaScript object
			const barangaysData = <%- JSON.stringify(barangays) %>;

			document.addEventListener('DOMContentLoaded', function() {
				const barangaySelect = document.getElementById('barangay-filter');
				const purokSelect = document.getElementById('purok-filter');

				// Populate Barangay options dynamically
				if (barangaysData && typeof barangaysData === 'object') {
					Object.keys(barangaysData).forEach(function(barangay) {
						const option = document.createElement('option');
						option.value = barangay;
						option.textContent = barangay;
						barangaySelect.appendChild(option);
					});
				}

				// Get existing DataTable instance
				var table = window.youthTable || $('#example').DataTable();

				// Initialize purok dropdown as disabled
				purokSelect.disabled = true;

				// When Barangay changes, populate Purok and filter table
				barangaySelect.addEventListener('change', function() {
					const selectedBarangay = this.value;
					purokSelect.innerHTML = '';

					const defaultOption = document.createElement('option');
					defaultOption.value = '';
					defaultOption.textContent = selectedBarangay ? 'Select Purok' : 'First select a Barangay';
					purokSelect.appendChild(defaultOption);

					purokSelect.disabled = !selectedBarangay;

					if (selectedBarangay && barangaysData[selectedBarangay]) {
						const allOption = document.createElement('option');
						allOption.value = 'all';
						allOption.textContent = 'All Puroks';
						purokSelect.appendChild(allOption);

						barangaysData[selectedBarangay].forEach(function(purok) {
							const option = document.createElement('option');
							option.value = purok;
							option.textContent = purok;
							purokSelect.appendChild(option);
						});
					}

					// Filter the table based on selected barangay (column index 2)
					table.columns(2).search(selectedBarangay || '').draw();
					// Clear purok filter when barangay changes
					table.columns(3).search('').draw();
				});

				// When Purok changes, filter table
				purokSelect.addEventListener('change', function() {
					const selectedPurok = this.value;
					if (selectedPurok === 'all' || selectedPurok === '') {
						table.columns(3).search('').draw();
					} else {
						table.columns(3).search(selectedPurok).draw();
					}
				});
			});
		</script>
	</body>
</html>